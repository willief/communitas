<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Communitas — Agents API</title>
    <meta name="description" content="Authoritative Agents API for Communitas + saorsa-core. Canonical signing, automation, and end-to-end flows." />
    
    <!-- Inter Font - Same as saorsalabs.com -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <span class="logo-text">Communitas</span>
                </a>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#features">Features</a></li>
                <li><a href="agents.html" style="color: var(--text-primary); font-weight: 600;">Agents API</a></li>
                <li><a href="agents-core.html">Core API</a></li>
                <li><a href="https://github.com/dirvine/communitas" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <main style="padding-top: 80px;">
        <section class="hero" style="padding: 4rem 0 3rem;">
            <div class="hero-container">
                <h1 style="font-size: 2.5rem;">Agents API</h1>
                <p class="hero-subtitle">Complete automation and security model for humans and AIs</p>
                <div class="hero-buttons">
                    <a href="https://github.com/dirvine/communitas/blob/main/AGENTS_API.md" class="btn btn-primary" target="_blank" rel="noopener">View on GitHub</a>
                    <a href="agents-core.html" class="btn btn-secondary">Core API</a>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div class="cta-section">
                    <div id="loading" style="color: var(--text-secondary);">Loading AGENTS_API.md…</div>
                    <article id="content" style="text-align: left; display: none;"></article>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 Saorsa Labs Limited. Dual-licensed under AGPL-3.0 and Commercial terms.</p>
            </div>
        </div>
    </footer>

    <script>
      (async function() {
        // Try local file first, fallback to GitHub
        const LOCAL_URL = 'AGENTS_API.md';
        const GITHUB_URL = 'https://raw.githubusercontent.com/dirvine/communitas/main/AGENTS_API.md';
        const loading = document.getElementById('loading');
        const content = document.getElementById('content');
        
        async function loadMarkdown(url) {
          const res = await fetch(url, { cache: 'no-cache' });
          if (!res.ok) throw new Error('HTTP ' + res.status);
          return await res.text();
        }
        
        try {
          // Try local first
          let md;
          try {
            md = await loadMarkdown(LOCAL_URL);
          } catch (localError) {
            // Fallback to GitHub
            md = await loadMarkdown(GITHUB_URL);
          }
          
          content.innerHTML = marked.parse(md);
          loading.style.display = 'none';
          content.style.display = 'block';
        } catch (e) {
          loading.textContent = 'Failed to load AGENTS_API.md: ' + (e && e.message ? e.message : e);
        }
      })();
    </script>
  </body>
  </html>